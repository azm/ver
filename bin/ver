#!/usr/bin/env ruby

if File.symlink?(__FILE__)
  lib = File.expand_path('../../lib/ver', File.readlink(__FILE__))
else
  lib = File.expand_path('../../lib/ver', __FILE__)
end

require 'optparse'

options = {
  fork:     true,
  keymap:   'vim',
  font_size: 9,
  font_family: 'Terminus',
  theme:    'Blackboard',
  tk_theme: 'clam',
}

op = OptionParser.new{|o|
  o.on('-f', '--nofork', 'stay attached to terminal'){ options[:fork] = false }
  o.on('-k', '--keymap NAME', 'vim or emacs'){|k| options[:keymap] = k }
  o.on('--font-size INT', 'font size'){|fs| options[:font_size] = fs }
  o.on('--font-family NAME', 'font family'){|fn| options[:font_family] = fn }
  o.on('-h', '--help', 'Show this help'){ puts o; exit }
}
op.parse!(ARGV)

if options[:fork]
  fork do
    fork do
      require lib
      VER.run(options)
    end
  end
else
  require lib
  VER.run(options)
end